{
  "id": "SND-08",
  "title": "Accept objc_unsafe_sendable boundary crossings with required unchecked-transfer warnings",
  "feature": "unsafe sendable escape-hatch diagnostics for auditable unchecked transfers",
  "bucket": "diagnostics",
  "profile": "strict",
  "references": [
    "spec/CONFORMANCE_PROFILE_CHECKLIST.md#e-3-7",
    "spec/ATTRIBUTE_AND_SYNTAX_CATALOG.md#b-3-3",
    "spec/PART_7_CONCURRENCY_ASYNC_AWAIT_ACTORS.md#part-7-8-3",
    "spec/PART_7_CONCURRENCY_ASYNC_AWAIT_ACTORS.md#part-7-8-5",
    "spec/PART_7_CONCURRENCY_ASYNC_AWAIT_ACTORS.md#part-7-8-6",
    "spec/PART_12_DIAGNOSTICS_TOOLING_TESTS.md#part-12-3-3"
  ],
  "source": "__attribute__((objc_unsafe_sendable))\n@interface SND08UnsafeBox : NSObject\n@property (nonatomic) int value;\n@end\n\ntypedef id SND08TaskHandle;\nSND08TaskHandle snd08_spawn(id (^work)(void) async) __attribute__((objc_task_spawn));\nid snd08_join(SND08TaskHandle handle) async;\nSND08UnsafeBox *snd08_main_hop(SND08UnsafeBox *value) async __attribute__((objc_executor(main)));\n\nactor class SND08Bridge : NSObject\n- (SND08UnsafeBox * _Nonnull)echo:(SND08UnsafeBox * _Nonnull)value;\n@end\n\nid snd08_escape_hatch(SND08Bridge *bridge, SND08UnsafeBox *box) async {\n    SND08TaskHandle task = snd08_spawn(^id(void) async {\n        return box;\n    });\n    SND08UnsafeBox *roundTrip = await [bridge echo:box];\n    SND08UnsafeBox *hopped = await snd08_main_hop(roundTrip);\n    (void)hopped;\n    return await snd08_join(task);\n}\n",
  "expect": {
    "parse": "accept",
    "diagnostics": [
      {
        "code": "OBJC3-D-CONC-UNSAFE-SENDABLE-TRANSFER",
        "severity": "warning",
        "span": {
          "start": { "line": 16, "column": 16 },
          "end": { "line": 16, "column": 19 }
        },
        "message": "unchecked transfer accepted via objc_unsafe_sendable for task capture of 'box'",
        "fixits": []
      },
      {
        "code": "OBJC3-D-CONC-UNSAFE-SENDABLE-TRANSFER",
        "severity": "warning",
        "span": {
          "start": { "line": 19, "column": 52 },
          "end": { "line": 19, "column": 54 }
        },
        "message": "unchecked transfer accepted via objc_unsafe_sendable for cross-actor argument 'box'",
        "fixits": []
      },
      {
        "code": "OBJC3-D-CONC-UNSAFE-SENDABLE-TRANSFER",
        "severity": "warning",
        "span": {
          "start": { "line": 20, "column": 51 },
          "end": { "line": 20, "column": 59 }
        },
        "message": "unchecked transfer accepted via objc_unsafe_sendable for cross-executor argument 'roundTrip'",
        "fixits": []
      }
    ]
  }
}
